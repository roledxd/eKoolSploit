gmainv2PH.getMenuItemsPermissions=function(){return gmainv2PH.permissions={requests:!0,timetable:!0,timetableAdmin:!0,reports:!0,fa:!0,recordBook:!0,interview:!0,interviewDemo:!0,descisions:!0,schoolyear:!0,recources:!0,curriculum:!0,gradesTransfer:!0,classificators:!0,addmission:!0,discipline:!0,fullDiscipline:!0,gradesTransferAdmin:!0,superAdminTool:!0,ads:!0,cafeteria:!0,devCardsTemplates:!0},gmainv2PH.permissions},gmainv2PH.showMenu=function(){var e=TemplateEngine.parseById("hidden_a_settings_fieldlist",{inst:gmainv2PH.groupObj.groupData,menuItemsPermissions:gmainv2PH.getMenuItemsPermissions(),joinReqCount:gmainv2PH.groupObj.joinReqCount,threadCountNew:0,assignedPlaceCount:gmainv2PH.groupObj.assignedPlaceCount,interviewNotifCount:gmainv2PH.groupObj.interviewNotifCount,grdesTransferredExcerptCount:gmainv2PH.groupObj.grdesTransferredExcerptCount,isAllowedTransfer:!0,isAllowedFormativeAssesment:!0});$("schoolDatatoolbar").update(e),setTimeout(function(){clayoutPH.makePageMenuPretty()},200)},gmainv2PH.initThis=function(e){null!=$("e_ekool_schoolloc")&&$("e_ekool_schoolloc").hide();var n=SWFAddress.getParameter("groupId");n&&n>0&&(gmainv2PH.groupId=n),gmainv2PH.absenceNoticesNotifMap=$H(),ccachePH.statesList(function(e){}),ccachePH.getPhoneTypesList(function(e){}),ccachePH.getEmailTypesList(function(e){}),chelperPH.loadTemplateHidd(chelperPH.resourcedir+gmainv2PH.foldername+"/mainv2/tpl/main_tpl.html",function(){gmainv2PH.getAbsenceNoticeNotifications(),ccachePH.groupObj(gmainv2PH.groupId,!1,function(n){ccachePH.statesList(function(i){ccachePH.getPhoneTypesList(function(i){ccachePH.getEmailTypesList(function(i){guserPH.userAccountTypes(this.groupId);$LAB.script(chelperPH.resourcedir+"g/"+chelperPH.getEffectiveJournalDir()+"/js/gjournalListPH.js?_"+chelperPH.journalRefreshForceString).wait(function(){this.groupObj=n,this.jrnlRet=null,chelperPH.callcode(e)}.bind(this))}.bind(this))}.bind(this))}.bind(this))}.bind(this))}.bind(this))},gmainv2PH.teacherAbsenceForm=function(e){chelperPH.loadTemplateHidd(chelperPH.resourcedir+"c/cal/tpl/employeeAway_tpl.html",function(){$LAB.script(chelperPH.resourcedir+"c/cal/js/employeeAwayPH.js").wait(function(){var n=chelperPH.arrFindById(e,gmainv2PH.groupObj.calendarEventList);null==n&&(n=chelperPH.arrFindById(e,gmainv2PH.eventList)),null==n&&(n={});employeeAwayPH.absenteeId=n.person.id,employeeAwayPH.substituteTeachers=[],gmainv2PH.getEmployeeListIfRights(function(e){chelperPH.sortMember(e);var i=gmainv2PH.groupObj.groupData.substitutionReasons.sort(subjectTypeSort),t=TemplateEngine.parseById("hidden_c_calendar_add_absence",{reasons:i,event:n,employeeList:e,hasRightsToChange:!0,hasTeacherRole:!0});clayoutPH.initMMModalDialog({hasCloseButton:!0,innerPadding:0,preferredWidth:600}),clayoutPH.updateMMModalDialogContent(t),employeeAwayPH.trainingInformationId=null,employeeAwayPH.openTrainingDataForm(n.trainingInformation),employeeAwayPH.trainingInformationId=n.trainingInformation.id})})})},gmainv2PH.getEmployeeListIfRights=function(e){peopleResourceManager.getAllActiveEmployeesByInstitutionId(gmainv2PH.groupId,{callback:function(n){gmainv2PH.employeeList=n.returnObject,e(gmainv2PH.employeeList)}})},gmainv2PH.showSchoolPage=function(e){chelperPH.loadTemplateHidd(chelperPH.resourcedir+"p/main/tpl/dashboard.html",function(){$LAB.script(chelperPH.resourcedir+"p/main/js/pmaindashPH.js").wait(function(){pmaindashPH.checkIfHarIDuserHasNewRoles(),gmainv2PH.showAppPromoToTeacher();var n=!1;if(gmainv2PH.groupObj.groupData.status==INST_STATUSES.OVERDUE||gmainv2PH.groupObj.groupData.status==INST_STATUSES.DISABLED){var i={title:"Данная школа просрочила оплату и услуги временно приостановлены. Пожалуйста, свяжитесь с администрацией школы для получения дальнейшей информации."};clayoutPH.nocontent("schoolDatamaincontent",i)}else{n=!0;var t=TemplateEngine.parseById("hidden_g_main_overview_v2_main_content",{showJournals:!0,groupObj:gmainv2PH.groupObj,showWarningOfCurrentYear:!0,currentYear:e,isEventsVisible:!0,teacherCanAddJournal:!0});$("schoolDatamaincontent").update(t),n&&(void 0===guserPH.user.selectedGroupId?guserPH.activateGroup(gmainv2PH.groupId,gmainv2PH.showJournals()):gmainv2PH.showJournals());var a=guserPH.userAccountTypes(gmainv2PH.groupId);if(guserPH.userIsLoggedIn()&&null!=a&&a.size()>0){t=TemplateEngine.parseById("hidden_g_main_overview_v2_personell",{personellList:$A()}),$("g_main_overview_v2_contacts").update(t);var r=0,o=[{id:0,name:"Учителя"},{id:1,name:"Администраторы"},{id:4,name:"Школы"},{id:2,name:"специалисты по поддержке"},{id:3,name:"Ученики"},{id:5,name:"Руководство школы"},{id:20,name:"Мои ученики"},{id:7,name:"Персонал"}]}chelperPH.sortMember(gmainv2PH.groupObj.groupAdminList,gmainv2PH.groupObj.groupData),chelperPH.sortMember(gmainv2PH.groupObj.groupTeacherList,gmainv2PH.groupObj.groupData),gmainv2PH.cfilterPH&&gmainv2PH.cfilterPH.groupId==gmainv2PH.groupId?(gmainv2PH.cfilterPH.filterDrawAndShow(),gmainv2PH.cfilterPH.filterAttachCallbacks()):(gmainv2PH.cfilterPH=new cfilterPH(o,!0,!1,gmainv2PH.personellFilterHandler.bind(gmainv2PH),r,["Поиск по имени... (RoLedXD's Mod)"],"g_main_overview_v2_contacts_personell_filter"),gmainv2PH.cfilterPH.groupId=gmainv2PH.groupId),gmainv2PH.personellFilterHandler(gmainv2PH.cfilterPH.getFilterValues().type,gmainv2PH.cfilterPH.getFilterValues().searchCriterion),clayoutPH.makePageMenuPretty(),gmainv2PH.showCurricula()&&gmainv2PH.curriculaContent(),t=TemplateEngine.parseById("hidden_g_main_overview_v2_events",{groupObj:gmainv2PH.groupObj,isAllowedModify:!0}),$("g_main_overview_v2_events").update(t),gmainv2PH.eventsList(),gmainv2PH.showBlog(),gmainv2PH.showAdverts()}})})},gmainv2PH.showCurricula=function(){return!0},gmainv2PH.getCurriculumHTMLForStudent=function(e,n){return TemplateEngine.parseById("hidden_g_main_overview_v2_curricula_view",{curricula:e,viewType:ROLES.TEACHER,subject:null,course:null,studentId:n.id})},gmainv2PH.curriculaShow=function(e){curriculumManager.curriculumFind(dwrNumber(e),dwrNumber(this.groupId),{callback:function(e){gmainv2PH.curricula.push(e.returnObject),clayoutPH.initModalBox();var n=TemplateEngine.parseById("hidden_g_main_overview_v2_curricula_view",{curricula:e.returnObject,viewType:ROLES.TEACHER,subject:null,course:null,studentId:null});$("modalbox_content").update(n)}})},gmainv2PH.eventsListDraw=function(e){if(0==e.length){var n={};n=1==gmainv2PH.eventsMode?{title:"За последние 30 дней событий не найдено"}:0==gmainv2PH.eventsMode?{title:"В следующие 30 дней не запланировано мероприятий."}:{title:"В этой школе не внесено ни одного события."},$("g_main_overview_v2_events_content").update('<li id = "g_main_overview_v2_events_content_linc" class="P20"></li>'),clayoutPH.nocontent("g_main_overview_v2_events_content_linc",n)}else{if(!$("g_main_overview_v2_events_content")){var i=TemplateEngine.parseById("hidden_g_main_overview_v2_events",{groupObj:gmainv2PH.groupObj,isAllowedModify:!0});$("g_main_overview_v2_events").update(i)}var t=TemplateEngine.parseById("hidden_g_main_overview_v2_events_content",{calendarEventList:e,instId:this.groupId,isAllowedModifyEvents:!0});$("g_main_overview_v2_events_content").update(t)}};
